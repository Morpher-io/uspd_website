# Security Audits

USPD has undergone comprehensive security audits by leading blockchain security firms to ensure the safety and reliability of the protocol. This page provides detailed summaries of the audit findings and the team's responses.

## Resonance Security Audit

**Audit Period:** June 10-20, 2025  
**Auditors:** Resonance Security  
**Scope:** USPD stablecoin smart contracts and NFT-based stabilizer system

[üìÑ View Full Resonance Audit Report](/documents/uspd_audit_resonance.pdf)

### Overview

Resonance Security conducted a thorough assessment of USPD's smart contracts, focusing on the unique NFT-based stabilizer system that underpins this USD-pegged stablecoin. The audit aimed to identify security vulnerabilities and verify correct functionality across all contract components.

### Code Quality Assessment

The audit team rated the project across three critical dimensions:

| Metric | Score | Rating | Notes |
|--------|-------|--------|-------|
| **Code Quality** | 7/10 | Good | Follows development best practices, uses standard libraries, highly readable |
| **Test Coverage** | 9/10 | Excellent | 96% code coverage with comprehensive unit and integration tests |
| **Documentation** | 9/10 | Excellent | Comprehensive specifications and technical details |

### Security Findings Summary

The audit identified **22 vulnerabilities** across different severity levels. The USPD team demonstrated strong security practices by resolving **18 of 22 findings**, with the remaining 4 acknowledged as accepted design trade-offs.

#### Critical Findings

| ID | Description | Status |
|----|-------------|--------|
| **RES-01** | Yield factor manipulation via direct stETH transfers to rateContract, potentially allowing malicious liquidations | ‚úÖ **Resolved** |

#### Medium Severity Findings

| ID | Description | Status |
|----|-------------|--------|
| **RES-02** | Unprotected `receive()` function in StabilizerEscrow could lead to native token loss | ‚úÖ **Resolved** |
| **RES-03** | Outdated price query signatures could be reused due to lack of nonce mechanism | ‚úÖ **Resolved** |
| **RES-04** | Uniform staleness period for price validation across different oracle sources | ‚úÖ **Resolved** |

#### Low Severity Findings

| ID | Description | Status |
|----|-------------|--------|
| **RES-05** | Centralization risk from admin-privileged minting/burning functions | ‚ö†Ô∏è **Acknowledged** |
| **RES-08** | L2 yield factor update logic doesn't account for L1 slashing events | ‚úÖ **Resolved** |
| **RES-13** | StabilizerNFT minting susceptible to front-running attacks | ‚ö†Ô∏è **Acknowledged** |

#### Informational Findings

| ID | Description | Status |
|----|-------------|--------|
| **RES-14** | Floating pragma version (^0.8.20) could lead to deployment inconsistencies | ‚úÖ **Resolved** |
| **RES-21** | `mint()` function doesn't follow Checks-Effects-Interactions pattern | ‚úÖ **Resolved** |

### Acknowledged Design Decisions

Several findings were acknowledged rather than resolved due to intentional design choices:

- **RES-05 (Centralization)**: Admin privileges are intentionally limited to bridge and L2 minting operations for regulatory compliance
- **RES-13 (Front-running)**: Permissionless minting is maintained by design for regulatory reasons, accepting the front-running risk

### Audit Methodology

Resonance employed a comprehensive approach combining:
- Automated source code analysis
- Manual security review by 3 engineers over 10 days
- Focus on common attack vectors: re-entrancy, front-running, unsafe external calls, access control

## Nethermind Security Audit

**Audit Completion:** August 20, 2025  
**Auditors:** Nethermind Security  
**Scope:** 10 core smart contracts and 11 interfaces (2,043 lines of Solidity code)

[üìÑ View Full Nethermind Audit Report](/documents/uspd_audit_nethermind.pdf)

### Overview

Nethermind Security conducted a comprehensive security review of the USPD Stablecoin protocol, employing both manual and automated analysis techniques. The audit focused on identifying security flaws in the core logic of the protocol's smart contracts.

### Code Quality Assessment

| Metric | Rating | Notes |
|--------|--------|-------|
| **Test Suite** | High | 85.55% mutation testing score - detected vast majority of injected bugs |
| **Documentation** | High | Detailed specifications, responsive team communication |

#### Mutation Testing Analysis

Nethermind performed detailed mutation testing to evaluate test suite thoroughness:
- **Overall Score:** 85.55% - excellent detection of injected bugs
- **StabilizerNFT.sol:** 78.25% (lowest score, indicating areas for improved coverage)
- **Assessment:** High-quality test suite with room for targeted improvements

### Security Findings Summary

The audit uncovered **12 issues** with significant critical and high-severity findings. The USPD team demonstrated exceptional security practices by **fixing 11 of 12 findings** (91.7% resolution rate), with only 1 acknowledged.

#### Critical Findings

| Description | Status |
|-------------|--------|
| **Global Collateralization Manipulation**: Stabilizer owners could bypass reporting by directly transferring stETH to PositionEscrow, preventing legitimate liquidations and causing DoS | ‚úÖ **Fixed** |
| **Price Oracle Inversion Error**: PriceOracle failed to invert Uniswap ETH/USDC price, causing permanent DoS for oracle-dependent functions | ‚úÖ **Fixed** |
| **Misconfigured Constant**: MINIMUM_UNALLOCATE_COLLATERALIZATION_RATIO set to 100 instead of scaled 10000, rendering health checks ineffective | ‚úÖ **Fixed** |

#### High Severity Findings

| Description | Status |
|-------------|--------|
| **Role Transfer Issue**: EXCESSCOLLATERALMANAGER_ROLE not transferred with StabilizerNFT ownership, allowing previous owners to withdraw collateral | ‚úÖ **Fixed** |
| **Gas Exhaustion Loss**: Out-of-gas scenarios in unallocateStabilizerFunds could permanently lose user shares | ‚úÖ **Fixed** |

#### Medium Severity Findings

| Description | Status |
|-------------|--------|
| **Minimal Collateral DoS**: Malicious stabilizers could block cUSPD minting by creating positions with minimal collateral (1 wei) | ‚úÖ **Fixed** |
| **Immediate Liquidation Risk**: Stabilizers could set collateralization ratios below liquidation thresholds, making positions immediately liquidatable | ‚úÖ **Fixed** |

#### Low Severity Findings

| Description | Status |
|-------------|--------|
| **Stale Yield Factor**: Delayed L1-to-L2 bridge messages could cause USPD devaluation and improper liquidations | ‚ö†Ô∏è **Acknowledged** |

### Key Security Insights

This audit revealed several critical architectural vulnerabilities:

1. **Price Oracle Integration Flaws**: Critical errors in price fetching and validation logic
2. **Collateral Accounting Issues**: Manipulation vectors in collateralization reporting
3. **Role Management Gaps**: Incomplete permission transfers during NFT ownership changes
4. **Gas-Related Vulnerabilities**: Potential for permanent fund loss during gas exhaustion

### Audit Methodology

Nethermind employed a comprehensive approach:
- **Manual Security Review**: Expert analysis of complex protocol logic
- **Automated Analysis**: Systematic vulnerability detection
- **Mutation Testing**: Rigorous evaluation of test suite effectiveness
- **Architectural Assessment**: Review of core protocol design decisions

### Notable Observations

- **High-quality test suite** (85.55% mutation score) did not prevent critical logical flaws
- Demonstrates the **critical importance of expert manual review** for complex DeFi protocols
- **Exceptional team response** with 91.7% issue resolution rate, including all critical/high findings
- Strong commitment to protocol security through comprehensive remediation efforts

---

## Security Commitment

The USPD protocol takes security seriously, as evidenced by:

- **High test coverage** (96%) with comprehensive unit and integration tests
- **Excellent documentation** providing clear specifications
- **Proactive security measures** with multiple independent audits
- **Transparent disclosure** of all findings and resolutions
- **Responsible design decisions** balancing security with regulatory requirements

For security researchers or users with security concerns, please review the full audit reports linked above or contact the team through our official channels.

---

*Last updated: {new Date().toLocaleDateString()}*
